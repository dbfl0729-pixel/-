<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>파파존스 시흥은행점 | 메뉴판</title>
<style>
:root{--brand:#104C55;--bg:#F8F9FB;--ink:#111;--muted:#6b7280;--warn:#ef4444}
*{box-sizing:border-box}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",sans-serif;color:var(--ink);background:var(--bg)}
header{position:sticky;top:0;background:#fff;border-bottom:1px solid #e5e7eb;z-index:30}
.wrap{max-width:1100px;margin:0 auto;padding:16px}
.brand{font-weight:800;color:var(--brand);font-size:20px}
.tel{margin-left:auto;background:var(--brand);color:#fff;padding:6px 10px;border-radius:8px;font-weight:700}
nav{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
nav a{padding:8px 12px;border-radius:999px;border:1px solid #e5e7eb;text-decoration:none;color:var(--ink);font-weight:700;background:#fff}
nav a.active{background:var(--brand);color:#fff;border-color:var(--brand)}
main{padding:20px 0}
.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
.card{grid-column:span 12;background:#fff;border:1px solid #e5e7eb;border-radius:14px;overflow:hidden;display:flex;gap:14px}
@media(min-width:720px){.card{grid-column:span 6}}
@media(min-width:1024px){.card{grid-column:span 4}}
.thumb{width:36%;min-height:140px;background:#f3f4f6;object-fit:cover}
.info{padding:12px;flex:1}
.name{font-weight:900}
.desc{color:var(--muted);font-size:13px;margin:4px 0 8px}
.meta{font-size:12px;color:#374151;line-height:1.5}
.price{margin-top:6px;font-weight:900}
.badge{display:inline-block;padding:2px 8px;border-radius:999px;font-size:11px;font-weight:900;margin-right:6px}
.b-best{background:#fde68a}.b-two{background:#bbf7d0}.b-th{background:#e5e7eb}.b-nc{background:#e0e7ff}
select,button{border:1px solid #e5e7eb;border-radius:10px;padding:8px 10px;background:#fff;font-weight:700}
button.primary{background:var(--brand);color:#fff;border-color:var(--brand)}
.note{font-size:12px;color:var(--muted)}
.hide{display:none}
.hero{background:#fff;border:1px solid #e5e7eb;border-radius:14px;padding:16px}
.admin{margin-top:10px;display:grid;gap:10px}
textarea{width:100%;min-height:160px;border:1px solid #e5e7eb;border-radius:10px;padding:10px;font-family:ui-monospace,Consolas,Menlo,monospace}
.warn{color:var(--warn)}
</style>
</head>
<body>
<header>
  <div class="wrap" style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
    <div class="brand">파파존스 시흥은행점 메뉴판</div>
    <span class="badge b-nc">대량 파싱 지원</span>
    <div class="tel">전화: 031-XXXX-XXXX</div>
  </div>
  <div class="wrap">
    <nav id="tabs">
      <a href="#home" class="active">첫화면</a>
      <a href="#pizza">피자</a>
      <a href="#sides">사이드</a>
      <a href="#drinks">음료&소스</a>
      <a href="#deals">제휴할인</a>
    </nav>
  </div>
</header>

<main class="wrap">
  <!-- 첫화면 + 관리자 파서 -->
  <section id="home" class="view">
    <div class="hero">
      <h3 style="margin:0 0 8px">데이터 붙여넣기 → 자동 생성</h3>
      <div class="note">IMG_로 시작하는 줄마다 새 항목으로 인식한다. 예: <code>IMG_7786.jpeg : 수퍼 파파스(best) : ...</code></div>
      <div class="admin">
        <textarea id="bulk" placeholder="여기에 방금 보낸 피자 목록 원문을 그대로 붙여 넣으세요."></textarea>
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <button class="primary" onclick="applyBulk()">파싱 후 적용</button>
          <button onclick="demoFill()">샘플 3종 채우기</button>
          <div class="note">키워드 인식: <b>BEST</b>, <b>best</b>, <b>1+1</b>, <b>TH전용</b>, <b>*TH전용*</b>, <b>크러스트 선택 없음</b>.</div>
        </div>
      </div>
    </div>
    <div style="height:12px"></div>
    <div class="grid" id="featured"></div>
  </section>

  <!-- 피자 -->
  <section id="pizza" class="view hide">
    <div class="grid" id="pizzaList"></div>
    <div class="note" style="margin-top:8px">
      일부 품목은 크러스트 변경 불가. TH전용은 씬·특정 사이즈 전용. 별표/전용/선택없음 표기 시 자동 비활성화.
    </div>
  </section>

  <!-- 사이드/음료 -->
  <section id="sides" class="view hide"><div class="note">사이드는 추후 동일 방식으로 붙여넣기 파싱 가능. 필드 키워드가 없으면 이름·가격만 표시.</div><div id="sideList" class="grid"></div></section>
  <section id="drinks" class="view hide"><div id="drinkList" class="grid"></div></section>

  <!-- 제휴 -->
  <section id="deals" class="view hide">
    <div class="hero">
      <h3 style="margin:0 0 8px">제휴·이벤트</h3>
      <ul>
        <li><span class="badge b-two">1+1</span> 표시 제품: 동일 또는 낮은 금액 1판 증정</li>
        <li><span class="badge b-th">TH전용</span> 제품은 TH 사이즈/도우 전용</li>
      </ul>
      <div class="note">점포 정책에 맞춰 문구 수정.</div>
    </div>
  </section>
</main>

<script>
/* ---------- 라우팅 ---------- */
const tabs = document.querySelectorAll('#tabs a');
const views = document.querySelectorAll('.view');
function goto(hash){
  tabs.forEach(a=>a.classList.toggle('active', a.getAttribute('href')===hash));
  views.forEach(v=>v.classList.toggle('hide','#'+v.id!==hash));
  history.replaceState(null,'',hash);
}
tabs.forEach(a=>a.addEventListener('click',e=>{e.preventDefault();goto(a.getAttribute('href'));}));
if(!location.hash) history.replaceState(null,'','#home'); else goto(location.hash);

/* ---------- 데이터 상태 ---------- */
let items = []; // 파싱 결과 저장

/* ---------- 파서 ---------- */
/*
입력 규칙:
- 시작: "IMG_*.jpg|jpeg|png" 로 시작하는 줄 → 새 항목
- " : " 또는 " -" 으로 이름/설명 구분
- "기본토핑:" 줄 파싱 → toppings[]
- "가격" 줄 파싱 → prices{regular,large,family,party,th}
- "오리지널/ 씬/ ..." 줄 파싱 → crust[]
- 배지: BEST/best, 1+1, TH전용, 크러스트 선택 없음
*/
function normalizeNumber(s){
  if(!s) return null;
  s = s.replace(/[^\d.,]/g,'').replace(/\./g,',');
  const parts = s.split(',');
  const n = parseInt(parts.join(''),10);
  return isFinite(n) ? n : null;
}
function parsePrices(line){
  // 예: "가격 레귤러1-2인용(23cm)19,900원 / 라지2-3인용(31cm)28,500원 / 패밀리3-4인용(36cm)33.900원 / 파티5-6인용(41cm)42,500원 (오리지널기준)"
  const map = {};
  const m = line.replace(/가격/,'').split(/[\/|]/);
  m.forEach(seg=>{
    const s = seg.trim();
    const size =
      /레귤러/.test(s) ? 'regular' :
      /라지/.test(s) ? 'large' :
      /패밀리/.test(s) ? 'family' :
      /파티/.test(s) ? 'party' :
      /TH|전용/.test(s) ? 'th' : null;
    const priceMatch = s.match(/([\d.,]+)\s*원?/);
    if(size && priceMatch){
      map[size] = normalizeNumber(priceMatch[1]);
    }
  });
  return map;
}
function parseCrust(line){
  // "오리지널/ 씬/ 치즈롤/ ..." → 배열
  return line.split(/[\/,]/).map(s=>s.trim()).filter(Boolean);
}
function flagBadges(str){
  const b=[];
  if(/BEST|\(best\)|베스트/i.test(str)) b.push('BEST');
  if(/1\+1|행사\s*피자/i.test(str)) b.push('1+1');
  if(/TH전용|TH\s*전용|TH전용\*|\*TH전용\*/i.test(str)) b.push('TH전용');
  if(/크러스트\s*선택\s*없음|크러스트\s*없음/i.test(str)) b.push('크러스트 없음');
  return b;
}
function applyBulk(){
  const raw = document.getElementById('bulk').value;
  if(!raw.trim()){ alert('데이터를 붙여 넣으세요.'); return; }
  const lines = raw.split(/\r?\n/).map(l=>l.trim()).filter(l=>l.length>0);
  const blocks = [];
  let cur = null;
  const startRe = /^IMG_\d+.*\.(?:jpe?g|png)/i;
  lines.forEach(l=>{
    if(startRe.test(l)){
      if(cur) blocks.push(cur);
      cur = [l];
    } else if(cur){
      cur.push(l);
    }
  });
  if(cur) blocks.push(cur);

  const parsed = blocks.map(block=>{
    // 첫 줄: "IMG_xxxx.jpeg : 이름 : 설명..." 형태
    const first = block[0];
    const img = first.match(/(IMG_\d+[^:\s)]*\.(?:jpe?g|png))/i)?.[1] || '';
    // 이름과 한줄 설명
    let nameDesc = first.replace(img,'').replace(/^[:\s\-]+/,'');
    if(!nameDesc && block[1]) nameDesc = block[1];
    const parts = nameDesc.split(/\s*:\s*/);
    const name = (parts[0]||'이름없음').replace(/\(best\)/i,'').trim();
    const desc = (parts.slice(1).join(' : ') || '').trim();
    const badges = flagBadges(first+' '+block.join(' '));

    // 기본토핑
    const topLine = block.find(x=>/^기본토핑\s*[:：]/.test(x)) || '';
    const toppings = topLine.replace(/^기본토핑\s*[:：]/,'').split(/[,\s·]+/).map(s=>s.trim()).filter(Boolean);

    // 가격
    const priceLine = block.find(x=>/^가격/.test(x)) || '';
    const prices = parsePrices(priceLine);

    // 크러스트
    let crust = [];
    const crustLine = block.find(x=>/(오리지널|씬|치즈롤|골드링|스파이시|크루아상|크러스트 선택 없음)/.test(x));
    if(crustLine){
      if(/크러스트 선택 없음|크러스트 없음/.test(crustLine) || badges.includes('TH전용')){
        crust = [];
      } else {
        crust = parseCrust(crustLine.replace(/선택가능|선택|가능|TH전용.*/g,''));
      }
    }

    return {img,name,desc,toppings,prices,crust,badges};
  });

  items = parsed;
  render();
  goto('#pizza');
}

/* ---------- 렌더 ---------- */
function badgeSpan(b){
  if(b==='BEST') return '<span class="badge b-best">BEST</span>';
  if(b==='1+1') return '<span class="badge b-two">1+1</span>';
  if(b==='TH전용') return '<span class="badge b-th">TH전용</span>';
  if(b==='크러스트 없음') return '<span class="badge b-nc">크러스트 없음</span>';
  return '';
}
function priceText(p){
  const order = ['regular','large','family','party','th'];
  const nam = {regular:'레귤러',large:'라지',family:'패밀리',party:'파티',th:'TH'};
  const parts=[];
  order.forEach(k=>{ if(p[k]) parts.push(`${nam[k]} ${p[k].toLocaleString('ko-KR')}원`);});
  return parts.join(' / ');
}
function render(){
  // 홈 featured: BEST 또는 1+1 우선 상위 6개
  const feat = document.getElementById('featured');
  const hot = [...items].filter(x=>x.badges.some(b=>b==='BEST'||b==='1+1')).slice(0,6);
  feat.innerHTML = hot.map(cardHTML).join('');

  // 피자 리스트
  const list = document.getElementById('pizzaList');
  list.innerHTML = items.map(cardHTML).join('');
}
function cardHTML(x){
  const crustTxt = x.crust && x.crust.length ? x.crust.join(' / ') : '크러스트 선택 불가';
  return `
  <article class="card">
    <img class="thumb" alt="${x.name}" src="${x.img}" onerror="this.style.background='#e5e7eb';this.removeAttribute('src')">
    <div class="info">
      <div class="name">${x.badges.map(badgeSpan).join('')}${x.name}</div>
      <div class="desc">${x.desc||''}</div>
      <div class="meta"><b>토핑</b> ${x.toppings.join(', ')||'-'}</div>
      <div class="meta"><b>크러스트</b> ${crustTxt}</div>
      <div class="price">${priceText(x.prices)||''}</div>
    </div>
  </article>`;
}

/* ---------- 데모 ---------- */
function demoFill(){
  const demo = `
IMG_7786.jpeg : 수퍼 파파스(best) : 신선한 토마토 소스 위에 각종 고기와 채소가 듬뿍
기본토핑 : 토마토 소스, 모짜렐라 치즈, 이탈리안 소시지, 양파, 청피망, 양송이, 블랙 올리브, 햄, 페퍼로니
가격 레귤러1-2인용(23cm)19,900원 / 라지2-3인용(31cm)28,500원 / 패밀리3-4인용(36cm)33,900원 / 파티5-6인용(41cm)42,500원 (오리지널기준)
오리지널/ 씬/ 치즈롤/ 골드링/ 스파이시갈릭치즈롤/ 크루아상(한정) 선택가능
**1+1행사 피자**

IMG_7787.jpeg : 존스 페이버릿(best) : 이탈리안 소시지, 페퍼로니와 6종 치즈
기본토핑 ; 토마토 소스, 모짜렐라 치즈, 아시아고 치즈, 폰티나 치즈, 프로볼로네 치즈, 로마노 치즈, 파마산 치즈, 이탈리안 소시지, 페퍼로니, 이탈리안 허브
가격 라지2-3인용(31cm)29,500원 / 패밀리3-4인용(36cm)34,900원 / 파티5-6인용(41cm)45,500원 (오리지널기준)
오리지널/ 씬/ 치즈롤/ 골드링/ 스파이시갈릭치즈롤/ 크루아상(한정) 선택가능
**1+1행사 피자**

IMG_7798.jpeg : 크리스피 치즈 페퍼로니 피자 : TH전용 치즈엣지
기본토핑: 2블랜드 치즈(파마산, 로마노), 토마토 소스, 모짜렐라 치즈, 페퍼로니
패밀리3-4인용(36cm)31,900 *TH전용*
`;
  document.getElementById('bulk').value = demo.trim();
}
</script>
</body>
</html>