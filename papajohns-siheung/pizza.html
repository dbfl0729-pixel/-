// assets/js/cart.js

// --- 1. ë©”ë‰´ ë°ì´í„° ì •ì˜ ---

// 1+1 ì´ë²¤íŠ¸ê°€ ì ìš©ë˜ëŠ” í”¼ì ID ëª©ë¡ (7ì¢…)
const EVENT_PIZZA_IDS = ['P05', 'P06', 'P08', 'P09', 'P10', 'P15', 'P16'];

// í¬ëŸ¬ìŠ¤íŠ¸ ì •ë³´ (ê°€ê²©ì€ L/R ê¸°ì¤€ì¸ priceL, F ê¸°ì¤€ì¸ priceF, P ê¸°ì¤€ì¸ priceP ìˆœì„œ)
const CRUST_OPTIONS = [
    { value: 'original', name: 'ì˜¤ë¦¬ì§€ë„ í¬ëŸ¬ìŠ¤íŠ¸', desc: 'ì«„ê¹ƒí•˜ê³  ê³ ì†Œí•œ ê¸°ë³¸ì— ì¶©ì‹¤í•œ ë§›', priceL: 0, priceF: 0, priceP: 0 },
    { value: 'thin', name: 'ì”¬ (Thin)', desc: 'ë°”ì‚­í•œ ì‹ê°, í’ë¶€í•œ í† í•‘ì„ ë”ìš± ë§›ë³´ê³  ì‹¶ë‹¤ë©´!', priceL: 0, priceF: 0, priceP: 0 },
    { value: 'cheeseroll', name: 'ì¹˜ì¦ˆë¡¤', desc: 'ì§­ì¡°ë¦„í•œ ì²´ë‹¤ì¹˜ì¦ˆê°€ ë¿Œë ¤ì§„ í¬ëŸ¬ìŠ¤íŠ¸ ì† ìŠ¤íŠ¸ë§ ì¹˜ì¦ˆì˜ ìœ í˜¹', priceL: 4000, priceF: 5000, priceP: 6000 },
    { value: 'goldring', name: 'ê³¨ë“œë§', desc: 'ë‹¬ì½¤í•œ ê³ êµ¬ë§ˆ ë¬´ìŠ¤ì™€ ìŠ¤íŠ¸ë§ ì¹˜ì¦ˆì˜ í™˜ìƒì ì¸ ë§Œë‚¨', priceL: 4000, priceF: 5000, priceP: 6000 },
    { value: 'spicygarliccheeseroll', name: 'ìŠ¤íŒŒì´ì‹œ ê°ˆë¦­ ì¹˜ì¦ˆë¡¤', desc: 'ë§¤ì½¤í•œ ê°ˆë¦­ ì†ŒìŠ¤ë¥¼ ë”í•œ ì¹˜ì¦ˆë¡¤', priceL: 5000, priceF: 6000, priceP: 7000 },
];

// 25ê°€ì§€ í”¼ì ë©”ë‰´ ì •ë³´ (ID, ì´ë¦„, ì„¤ëª…, ê°€ê²©: R/L/F/P ìˆœì„œ)
const PIZZA_MENU = [
    // (ì´ì „ ë‹µë³€ì˜ 25ê°€ì§€ í”¼ì ë©”ë‰´ ë°ì´í„° ê·¸ëŒ€ë¡œ ìœ ì§€)
    { id: 'P01', name: 'ìŠˆí¼ íŒŒíŒŒìŠ¤', desc: 'í˜í¼ë¡œë‹ˆ, í–„, ì˜¬ë¦¬ë¸Œ, ë²„ì„¯, ì–‘íŒŒ, í”¼ë§ ë“± 8ê°€ì§€ í† í•‘ì´ í’ì„±í•œ í”¼ì', prices: { R: 23900, L: 30900, F: 36900, P: 41900 }, category: 'Premium' },
    { id: 'P02', name: 'ì¡´ìŠ¤ í˜ì´ë²„ë¦¿', desc: 'íŒŒíŒŒì¡´ìŠ¤ë§Œì˜ 6ê°€ì§€ íŠ¹ë³„ í† í•‘ì´ í™˜ìƒì ì¸ ì¡°í™”!', prices: { R: 25900, L: 32900, F: 38900, P: 43900 }, category: 'Premium' },
    { id: 'P03', name: 'ì•„ì´ë¦¬ì‰¬ í¬í…Œì´í† ', desc: 'ê°ˆë¦­ ëœì¹˜ ì†ŒìŠ¤ì™€ ê°ìê°€ ë§Œë‚˜ ê³ ì†Œí•˜ê³  ë‹´ë°±í•œ ë§›', prices: { R: 23900, L: 30900, F: 36900, P: 41900 }, category: 'Premium' },
    { id: 'P04', name: 'ë”ë¸” ì¹˜ì¦ˆë²„ê±°', desc: 'ê³ ê¸° í† í•‘ê³¼ 4ê°€ì§€ ì¹˜ì¦ˆì˜ ì¡°í™”, ì¹˜ì¦ˆë²„ê±°ì˜ í’ë¯¸ë¥¼ í”¼ì í•œ íŒì—!', prices: { R: 25900, L: 32900, F: 38900, P: 43900 }, category: 'Premium' },
    { id: 'P05', name: 'ìŠ¤íŒŒì´ì‹œ ì¹˜í‚¨ ëœì¹˜', desc: 'ë§¤ì½¤í•œ ì¹˜í‚¨ê³¼ ëœì¹˜ ì†ŒìŠ¤ì˜ í™˜ìƒ ì¡°í•©! (1+1 ê°€ëŠ¥)', prices: { R: 22900, L: 29900, F: 35900, P: 40900 }, category: 'Signature' },
    { id: 'P06', name: 'í˜í¼ë¡œë‹ˆ', desc: 'ì§­ì§¤í•œ í˜í¼ë¡œë‹ˆì™€ ì¹˜ì¦ˆì˜ í´ë˜ì‹í•œ ì¡°í•©! (1+1 ê°€ëŠ¥)', prices: { R: 20900, L: 27900, F: 33900, P: 38900 }, category: 'Signature' },
    { id: 'P07', name: 'í•˜ì™€ì´ì•ˆ', desc: 'í–„ê³¼ íŒŒì¸ì• í”Œì´ ë§Œë‚˜ ë‹¬ì½¤ ìƒí¼í•œ ë§›', prices: { R: 20900, L: 27900, F: 33900, P: 38900 }, category: 'Signature' },
    { id: 'P08', name: 'ì˜¬ë¯¸íŠ¸', desc: 'ê³ ê¸° ë§¤ë‹ˆì•„ë¥¼ ìœ„í•œ ì†Œì‹œì§€, í–„, ë² ì´ì»¨ í† í•‘ì˜ í–¥ì—°! (1+1 ê°€ëŠ¥)', prices: { R: 23900, L: 30900, F: 36900, P: 41900 }, category: 'Signature' },
    { id: 'P09', name: 'ë§ˆê°€ë¦¬íƒ€', desc: 'ì‹ ì„ í•œ í† ë§ˆí† ì™€ ë°”ì§ˆ, ëª¨ì§œë ë¼ ì¹˜ì¦ˆì˜ ê¹”ë”í•¨! (1+1 ê°€ëŠ¥)', prices: { R: 18900, L: 25900, F: 31900, P: 36900 }, category: 'Signature' },
    { id: 'P10', name: 'ì¹˜í‚¨ ë°”ë² í', desc: 'ë°”ë² í ì†ŒìŠ¤ì— ë²„ë¬´ë¦° ì¹˜í‚¨ê³¼ ì–‘íŒŒì˜ ë‹¬ì½¤ ì§­ì§¤í•œ ë§›! (1+1 ê°€ëŠ¥)', prices: { R: 22900, L: 29900, F: 35900, P: 40900 }, category: 'Signature' },
    { id: 'P11', name: 'ê°€ë“  ìŠ¤í˜ì…œ', desc: 'ë‹¤ì–‘í•œ ì•¼ì±„ì™€ ì¹˜ì¦ˆì˜ ê±´ê°•í•œ ë§›', prices: { R: 20900, L: 27900, F: 33900, P: 38900 }, category: 'Signature' },
    { id: 'P12', name: 'ì¹˜ì¦ˆ', desc: 'ëª¨ì§œë ë¼ ì¹˜ì¦ˆ ë³¸ì—°ì˜ ë§›ì„ ì¦ê¸°ëŠ” í”¼ì', prices: { R: 18900, L: 25900, F: 31900, P: 36900 }, category: 'Classic' },
    { id: 'P13', name: 'ë² ì´ì»¨ í† ë§ˆí† ', desc: 'ì§­ì§¤í•œ ë² ì´ì»¨ê³¼ ì‹ ì„ í•œ í† ë§ˆí† ì˜ ë§Œë‚¨', prices: { R: 22900, L: 29900, F: 35900, P: 40900 }, category: 'Classic' },
    { id: 'P14', name: 'í•«ì•¤ìŠ¤íŒŒì´ì‹œ ë©•ì‹œì¹¸', desc: 'ë§¤ì½¤í•œ ë§›ì„ ì¦ê¸°ëŠ” ë¶„ë“¤ì„ ìœ„í•œ í”¼ì', prices: { R: 23900, L: 30900, F: 36900, P: 41900 }, category: 'Classic' },
    { id: 'P15', name: 'ìˆ˜í¼ íŒŒíŒŒìŠ¤ ì”¬', desc: 'ìŠˆí¼ íŒŒíŒŒìŠ¤ë¥¼ ì”¬ í¬ëŸ¬ìŠ¤íŠ¸ë¡œ ì¦ê¸°ì„¸ìš”! (1+1 ê°€ëŠ¥)', prices: { R: 23900, L: 30900, F: 36900, P: 41900 }, category: 'Classic' },
    { id: 'P16', name: 'í˜í¼ë¡œë‹ˆ ì”¬', desc: 'í˜í¼ë¡œë‹ˆë¥¼ ì”¬ í¬ëŸ¬ìŠ¤íŠ¸ë¡œ ì¦ê¸°ì„¸ìš”! (1+1 ê°€ëŠ¥)', prices: { R: 20900, L: 27900, F: 33900, P: 38900 }, category: 'Classic' },
    { id: 'P17', name: 'ì˜¬ë¯¸íŠ¸ ì¹˜ì¦ˆë¡¤', desc: 'ì˜¬ë¯¸íŠ¸ì— ì¹˜ì¦ˆë¡¤ í¬ëŸ¬ìŠ¤íŠ¸ ì¶”ê°€!', prices: { R: 27900, L: 34900, F: 40900, P: 45900 }, category: 'Classic' },
    { id: 'P18', name: 'ì•„ì´ë¦¬ì‰¬ í¬í…Œì´í†  ê³¨ë“œë§', desc: 'ì•„ì´ë¦¬ì‰¬ í¬í…Œì´í† ì— ê³¨ë“œë§ í¬ëŸ¬ìŠ¤íŠ¸ ì¶”ê°€!', prices: { R: 27900, L: 34900, F: 40900, P: 45900 }, category: 'Classic' },
    { id: 'P19', name: 'ë”ë¸” íŠ¸ë¦¬í”Œ ë°•ìŠ¤ (í”¼ì 2íŒ)', desc: 'í´ë˜ì‹ í”¼ì 2íŒì„ í•œ ë²ˆì—!', prices: { R: 35900, L: 47900, F: 58900, P: 68900 }, category: 'New' },
    { id: 'P20', name: 'ë¯¸íŠ¸ë³¼ ìŠ¤íŒŒê²Œí‹° í”¼ì', desc: 'ë¯¸íŠ¸ë³¼ê³¼ ìŠ¤íŒŒê²Œí‹°ì˜ í™˜ìƒì ì¸ ì½œë¼ë³´', prices: { R: 25900, L: 32900, F: 38900, P: 43900 }, category: 'New' },
    { id: 'P21', name: 'ì‹ìŠ¤ ì¹˜ì¦ˆ', desc: '6ê°€ì§€ ë‹¤ì–‘í•œ ì¹˜ì¦ˆì˜ í’ë¶€í•œ ë§›', prices: { R: 23900, L: 30900, F: 36900, P: 41900 }, category: 'New' },
    { id: 'P22', name: 'ë² ì§€í…Œë¦¬ì–¸', desc: 'ì±„ì†Œ í† í•‘ë§Œìœ¼ë¡œ ë§Œë“  ë‹´ë°±í•œ í”¼ì', prices: { R: 20900, L: 27900, F: 33900, P: 38900 }, category: 'New' },
    { id: 'P23', name: 'í˜í¼ë¡œë‹ˆ ê³¨ë“œë§', desc: 'í˜í¼ë¡œë‹ˆì— ê³¨ë“œë§ í¬ëŸ¬ìŠ¤íŠ¸ ì¶”ê°€', prices: { R: 24900, L: 31900, F: 37900, P: 42900 }, category: 'New' },
    { id: 'P24', name: 'íŠ¸ë¦¬í”Œ ì¹˜ì¦ˆë¡¤', desc: 'í¬ëŸ¬ìŠ¤íŠ¸ì— 3ê°€ì§€ ì¹˜ì¦ˆë¥¼ ê°€ë“ ì±„ìš´ í”¼ì', prices: { R: 25900, L: 32900, F: 38900, P: 43900 }, category: 'New' },
    { id: 'P25', name: 'ìŠˆí¼ íŒŒíŒŒìŠ¤ ê³¨ë“œë§', desc: 'ìŠˆí¼ íŒŒíŒŒìŠ¤ì— ê³¨ë“œë§ í¬ëŸ¬ìŠ¤íŠ¸ ì¶”ê°€', prices: { R: 27900, L: 34900, F: 40900, P: 45900 }, category: 'New' },
];


// --- 2. í—¬í¼ í•¨ìˆ˜ ---

// ê°€ê²© í¬ë§· í•¨ìˆ˜
const formatPrice = (price) => {
    // ìˆ«ìê°€ ì•„ë‹ˆê±°ë‚˜ ìŒìˆ˜ì´ë©´ 0ìœ¼ë¡œ ì²˜ë¦¬
    if (typeof price !== 'number' || isNaN(price) || price < 0) return '0';
    return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
};

// í”¼ì IDë¡œ ë©”ë‰´ ì •ë³´ ì°¾ê¸°
const getPizzaData = (pizzaId) => {
    return PIZZA_MENU.find(p => p.id === pizzaId);
};

// í¬ëŸ¬ìŠ¤íŠ¸ valueë¡œ í¬ëŸ¬ìŠ¤íŠ¸ ì •ë³´ ì°¾ê¸°
const getCrustData = (crustValue) => {
    return CRUST_OPTIONS.find(c => c.value === crustValue);
};

// í˜„ì¬ ìš”ì¼ì´ ê¸ˆìš”ì¼ì¸ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜ (0=ì¼, 5=ê¸ˆ)
const isFriday = () => {
    return new Date().getDay() === 5;
};

// 1+1 ê³„ì‚° ë¡œì§ í•¨ìˆ˜
const calculateOnePlusOnePrice = (pizza1, pizza2) => {
    // 1. ê¸°ë³¸ í”¼ì ê°€ê²©
    const price1 = pizza1.basePrice;
    const price2 = pizza2.basePrice;
    // 2. ë¹„ì‹¼ í”¼ì ê°€ê²©ì„ ê¸°ì¤€ìœ¼ë¡œ ê²°ì œ
    const paidPrice = Math.max(price1, price2);
    // 3. í¬ëŸ¬ìŠ¤íŠ¸ ì¶”ê°€ê¸ˆì€ ê°ê° ë¶€ê³¼
    const totalCrustExtra = pizza1.crustExtraPrice + pizza2.crustExtraPrice;
    // 4. ìµœì¢… 1+1 ê°€ê²©
    return paidPrice + totalCrustExtra;
};


// --- 3. í•µì‹¬ ê³„ì‚° í•¨ìˆ˜ (ê°€ê²© ì—…ë°ì´íŠ¸) ---

let onePlusOneCart = []; // ì „ì—­ ë³€ìˆ˜ë¡œ 1+1 ì„ íƒ í”¼ì ëª©ë¡ì„ ê´€ë¦¬

const updatePrice = (pizzaId) => {
    const card = document.querySelector(`.menu-item[data-id="${pizzaId}"]`);
    if (!card) return;

    const pizzaData = getPizzaData(pizzaId);
    if (!pizzaData) return;
    
    const sizeSelect = card.querySelector('.size-select');
    const crustSelect = card.querySelector('.crust-select');
    const totalPriceElement = document.getElementById(`total-price-${pizzaId}`);
    
    const isEventPizza = EVENT_PIZZA_IDS.includes(pizzaId);
    const isTodayFriday = isFriday();

    // 1. ì‚¬ì´ì¦ˆ ë° ê¸°ë³¸ ê°€ê²© ê²°ì •
    let selectedSize = sizeSelect ? sizeSelect.value : 'L';
    
    // ê¸ˆìš”ì¼ & ì´ë²¤íŠ¸ í”¼ìì¼ ê²½ìš° L ì‚¬ì´ì¦ˆ ê°•ì œ ê³ ì •
    if (isEventPizza && isTodayFriday) {
        selectedSize = 'L';
    }
    
    const basePrice = pizzaData.prices[selectedSize] || 0; // ê°€ê²©ì´ ì—†ìœ¼ë©´ 0ì› ì²˜ë¦¬
    
    // 2. í¬ëŸ¬ìŠ¤íŠ¸ ì¶”ê°€ê¸ˆ ê²°ì •
    let crustExtraPrice = 0;
    if (crustSelect) {
        const selectedCrustValue = crustSelect.value;
        const crustData = getCrustData(selectedCrustValue);
        
        if (crustData) {
            // ì„ íƒëœ ì‚¬ì´ì¦ˆì— ë§ëŠ” í¬ëŸ¬ìŠ¤íŠ¸ ì¶”ê°€ê¸ˆ í‚¤ë¥¼ ê²°ì •
            const sizePriceKey = { 'R': 'priceL', 'L': 'priceL', 'F': 'priceF', 'P': 'priceP' }; 
            const priceKey = sizePriceKey[selectedSize];
            
            // í¬ëŸ¬ìŠ¤íŠ¸ ì¶”ê°€ê¸ˆ ì ìš© (L/R ì‚¬ì´ì¦ˆëŠ” priceLì„ ì‚¬ìš©)
            crustExtraPrice = crustData[priceKey] !== undefined ? crustData[priceKey] : 0;
            
            // ì”¬ í¬ëŸ¬ìŠ¤íŠ¸ì˜ ì˜ˆì™¸ ì²˜ë¦¬: F ì‚¬ì´ì¦ˆ ë¬´ë£Œ ë³€ê²½ ì™¸ì—ëŠ” 0ì›
            if (selectedCrustValue === 'thin' && selectedSize !== 'F') {
                 crustExtraPrice = 0;
            }
        }
    }

    // 3. ìµœì¢… ê°€ê²© ê³„ì‚° ë° í‘œì‹œ (ë‹¨í’ˆ ê°€ê²©)
    const finalPrice = basePrice + crustExtraPrice;

    if (totalPriceElement) {
        totalPriceElement.textContent = formatPrice(finalPrice);
    }
};


// --- 4. ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ---

// 1+1 ì¥ë°”êµ¬ë‹ˆ ìƒíƒœ í‘œì‹œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (ì´ì „ ë‹µë³€ ì½”ë“œ ìœ ì§€)
const updateOnePlusOneStatus = () => {
    const statusElement = document.getElementById('one-plus-one-status');
    const isTodayFriday = isFriday();
    if (!statusElement) return;

    if (!isTodayFriday) {
        statusElement.textContent = 'ì˜¤ëŠ˜ì€ íŒŒíŒŒí”„ë¼ì´ë°ì´(1+1) í–‰ì‚¬ê°€ ì•„ë‹™ë‹ˆë‹¤.';
        statusElement.style.color = '#333';
        return;
    }
    
    if (onePlusOneCart.length === 0) {
        statusElement.innerHTML = 'ğŸ• **1+1 í”¼ìë¥¼ 2ê°œ ì„ íƒí•´ ì£¼ì„¸ìš”!** (í¬ì¥ ì „ìš©)';
        statusElement.style.color = '#CC0000';
    } else if (onePlusOneCart.length === 1) {
        statusElement.innerHTML = `âœ… ì²« ë²ˆì§¸ í”¼ì ì„ íƒ ì™„ë£Œ! ë‘ ë²ˆì§¸ í”¼ìë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”. <strong>(${onePlusOneCart[0].name})</strong>`;
        statusElement.style.color = '#5cb85c';
    }
};


document.addEventListener('DOMContentLoaded', () => {
    // 1+1 ìƒíƒœ í‘œì‹œ ì˜ì—­ì„ HTMLì— ì¶”ê°€ (ë©”ë‰´ê°€ ë¡œë“œëœ í›„)
    const statusDiv = document.createElement('div');
    statusDiv.id = 'one-plus-one-status';
    statusDiv.style.cssText = 'position: fixed; bottom: 10px; right: 10px; padding: 10px; background: #fff; border: 2px solid #CC0000; border-radius: 5px; box-shadow: 0 0 10px rgba(0,0,0,0.2); z-index: 1000; font-weight: bold; transition: all 0.3s;';
    document.body.appendChild(statusDiv);
    updateOnePlusOneStatus();
    
    
    const menuCards = document.querySelectorAll('.menu-item');

    menuCards.forEach(card => {
        const pizzaId = card.getAttribute('data-id');
        const sizeSelect = card.querySelector('.size-select');
        const crustSelect = card.querySelector('.crust-select');
        const addButton = card.querySelector('.add-to-cart-btn');
        const pizzaData = getPizzaData(pizzaId);

        // ì‚¬ì´ì¦ˆ/í¬ëŸ¬ìŠ¤íŠ¸ ë³€ê²½ ì‹œ ê°€ê²© ì—…ë°ì´íŠ¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        if (sizeSelect) {
            sizeSelect.addEventListener('change', () => {
                updatePrice(pizzaId);
            });
        }
        if (crustSelect) {
            crustSelect.addEventListener('change', () => {
                updatePrice(pizzaId);
            });
        }

        if (addButton) {
            addButton.addEventListener('click', () => {
                const isEventPizza = EVENT_PIZZA_IDS.includes(pizzaId);
                const isTodayFriday = isFriday();

                // --- 1+1 ì´ë²¤íŠ¸ ì²˜ë¦¬ ---
                if (isTodayFriday && isEventPizza) {
                    // (ì´ì „ ë‹µë³€ì˜ 1+1 ì£¼ë¬¸ ë¡œì§ ìœ ì§€)
                     if (onePlusOneCart.length >= 2) {
                        alert('âš ï¸ 1+1 í–‰ì‚¬ëŠ” í”¼ì 2ê°œê¹Œì§€ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ˆê¸°í™” í›„ ë‹¤ì‹œ ì„ íƒí•´ ì£¼ì„¸ìš”.');
                        onePlusOneCart = [];
                        updateOnePlusOneStatus();
                        return;
                    }

                    const currentSelectedPizza = {
                        id: pizzaId,
                        name: pizzaData.name,
                        basePrice: pizzaData.prices['L'],
                        crustName: crustSelect ? crustSelect.options[crustSelect.selectedIndex].textContent.split('(')[0].trim() : 'ì˜¤ë¦¬ì§€ë„',
                        crustExtraPrice: getCrustData(crustSelect.value).priceL || 0, 
                    };
                    
                    onePlusOneCart.push(currentSelectedPizza);
                    
                    if (onePlusOneCart.length === 1) {
                        alert(`âœ… íŒŒíŒŒí”„ë¼ì´ë°ì´ 1+1 - ì²« ë²ˆì§¸ í”¼ì (${pizzaData.name}) ì„ íƒ ì™„ë£Œ! ì´ì œ ë‘ ë²ˆì§¸ í”¼ìë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.`);
                        updateOnePlusOneStatus();
                    } else if (onePlusOneCart.length === 2) {
                        const [p1, p2] = onePlusOneCart;
                        const finalPrice = calculateOnePlusOnePrice(p1, p2);
                        
                        alert(`
                            ğŸ‰ íŒŒíŒŒí”„ë¼ì´ë°ì´ 1+1 ì£¼ë¬¸ ì™„ë£Œ (í¬ì¥ ì „ìš©, ë°°ë‹¬ ë¶ˆê°€)
                            ğŸ• 1: ${p1.name} (L / ${p1.crustName} +${formatPrice(p1.crustExtraPrice)}ì›)
                            ğŸ• 2: ${p2.name} (L / ${p2.crustName} +${formatPrice(p2.crustExtraPrice)}ì›)
                            ğŸ’µ ìµœì¢… 1+1 ê°€ê²©: ${formatPrice(finalPrice)}ì› (ë°°ë‹¬ë¹„ 3,000ì› ë©´ì œ)
                        `);
                        
                        onePlusOneCart = [];
                        updateOnePlusOneStatus();
                    }

                } else {
                    // --- ì¼ë°˜ ì£¼ë¬¸ ì²˜ë¦¬ ---
                    const selectedSize = sizeSelect ? sizeSelect.value : 'L';
                    const selectedCrust = crustSelect ? crustSelect.options[crustSelect.selectedIndex].textContent : 'ì˜¤ë¦¬ì§€ë„';
                    const finalPrice = document.getElementById(`total-price-${pizzaId}`).textContent.replace(/,/g, '');
                    const pizzaName = card.getAttribute('data-name');
                    
                    alert(`
                        ğŸ§¾ ì¼ë°˜ ì£¼ë¬¸ ì¶”ê°€ë¨ (ë°°ë‹¬ë¹„ 3,000ì› ë³„ë„):
                        - ë©”ë‰´: ${pizzaName}
                        - ì‚¬ì´ì¦ˆ: ${selectedSize}
                        - í¬ëŸ¬ìŠ¤íŠ¸: ${selectedCrust.split('(')[0].trim()}
                        - ìµœì¢… ê°€ê²©: ${finalPrice}ì›
                    `);
                }
            });
        }

        // ì´ˆê¸° ê°€ê²© ì„¤ì •: í”¼ì ì¹´ë“œê°€ DOMì— ì¶”ê°€ëœ í›„ ë°”ë¡œ ì‹¤í–‰
        updatePrice(pizzaId);
    });
});